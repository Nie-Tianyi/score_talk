{
  "openapi": "3.1.0",
  "info": {
    "title": "Forum & Topic Rating API",
    "version": "0.1.0"
  },
  "paths": {
    "/api/v1/auth/register": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Register",
        "description": "用户注册端点\n\n这个端点允许新用户创建账户，接收用户信息并创建新用户记录。\n\n工作流程：\n1. 检查用户名是否已被注册\n2. 对密码进行哈希处理\n3. 创建新用户记录\n4. 返回创建的用户信息（不包含密码）\n\nArgs:\n    user_in: 用户注册信息，包含用户名、密码、昵称和角色\n    db: 数据库会话，用于执行数据库操作\n\nReturns:\n    UserOut: 创建成功的用户信息（不包含密码哈希）\n\nRaises:\n    HTTPException: 当用户名已被注册时返回400错误\n\nExample Request:\n    POST /api/v1/auth/register\n    {\n        \"username\": \"newuser\",\n        \"password\": \"securepassword123\",\n        \"nickname\": \"New User\",\n        \"role\": \"user\"\n    }\n\nExample Response:\n    {\n        \"user_id\": 1,\n        \"username\": \"newuser\",\n        \"nickname\": \"New User\",\n        \"role\": \"user\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }",
        "operationId": "register_api_v1_auth_register_post",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserCreate"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/auth/token": {
      "post": {
        "tags": [
          "auth"
        ],
        "summary": "Login",
        "description": "用户登录端点（获取访问令牌）\n\n这个端点验证用户凭据并返回JWT访问令牌。\n使用OAuth2密码流程，这是最常用的认证方式。\n\n工作流程：\n1. 根据用户名查找用户\n2. 验证密码是否正确\n3. 生成JWT访问令牌\n4. 返回令牌信息\n\nArgs:\n    form_data: OAuth2密码请求表单，包含用户名和密码\n    db: 数据库会话，用于查询用户信息\n\nReturns:\n    Token: 包含访问令牌和令牌类型的响应\n\nRaises:\n    HTTPException: 当用户名或密码错误时返回400错误\n\nExample Request:\n    POST /api/v1/auth/token\n    Content-Type: application/x-www-form-urlencoded\n    username=newuser&password=securepassword123\n\nExample Response:\n    {\n        \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"token_type\": \"bearer\"\n    }\n\nSecurity Notes:\n    - 客户端应该在Authorization头中使用Bearer令牌：Authorization: Bearer <token>\n    - 令牌有过期时间，客户端需要处理令牌刷新\n    - 建议在生产环境中使用HTTPS传输敏感信息",
        "operationId": "login_api_v1_auth_token_post",
        "requestBody": {
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "$ref": "#/components/schemas/Body_login_api_v1_auth_token_post"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Token"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/users/me": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "Read Me",
        "description": "获取当前用户信息端点\n\n这个端点返回当前已认证用户的个人信息。\n用户通过JWT令牌进行认证，系统会自动识别当前用户。\n\n工作流程：\n1. 依赖注入系统自动调用get_current_user函数验证JWT令牌\n2. 从令牌中提取用户ID并查询数据库\n3. 返回当前用户的完整信息\n\nArgs:\n    current_user: 通过依赖注入获取的当前认证用户对象\n\nReturns:\n    UserOut: 当前用户的详细信息（不包含密码等敏感信息）\n\nExample Request:\n    GET /api/v1/users/me\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n\nExample Response:\n    {\n        \"user_id\": 1,\n        \"username\": \"john_doe\",\n        \"nickname\": \"John Doe\",\n        \"role\": \"user\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }\n\nSecurity Notes:\n    - 需要有效的JWT访问令牌\n    - 返回的信息不包含密码哈希等敏感数据\n    - 每个用户只能访问自己的信息",
        "operationId": "read_me_api_v1_users_me_get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserOut"
                }
              }
            }
          }
        },
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ]
      }
    },
    "/api/v1/users/": {
      "get": {
        "tags": [
          "users"
        ],
        "summary": "List Users",
        "description": "列出所有用户端点（管理员功能，支持分页）\n\n这个端点返回系统中所有注册用户的列表。\n只有具有管理员权限的用户可以访问此端点。\n支持分页查询，可以控制每页显示的数量和当前页码。\n\n工作流程：\n1. 依赖注入系统验证当前用户是否为管理员\n2. 如果不是管理员，返回403禁止访问错误\n3. 计算分页偏移量\n4. 查询数据库获取用户总数\n5. 查询当前页的用户数据\n6. 计算分页元数据\n7. 返回分页响应\n\nArgs:\n    pagination: 分页参数，包含页码和每页数量\n    db: 数据库会话，用于执行查询操作\n    admin: 通过依赖注入验证的管理员用户对象\n\nReturns:\n    PaginatedResponse[UserOut]: 包含分页元数据和用户列表的响应\n\nRaises:\n    HTTPException: 当用户不是管理员时返回403错误\n\nExample Request:\n    GET /api/v1/users/?page=2&per_page=10\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n\nExample Response:\n    {\n        \"items\": [\n            {\n                \"user_id\": 20,\n                \"username\": \"user20\",\n                \"nickname\": \"用户20\",\n                \"role\": \"user\",\n                \"created_at\": \"2024-01-20T00:00:00\"\n            },\n            {\n                \"user_id\": 19,\n                \"username\": \"user19\",\n                \"nickname\": \"用户19\",\n                \"role\": \"user\",\n                \"created_at\": \"2024-01-19T00:00:00\"\n            }\n        ],\n        \"total\": 50,\n        \"page\": 2,\n        \"per_page\": 10,\n        \"total_pages\": 5,\n        \"has_prev\": true,\n        \"has_next\": true\n    }\n\nSecurity Notes:\n    - 需要管理员权限才能访问\n    - 返回的信息不包含密码哈希等敏感数据\n    - 支持分页查询，默认每页20条，最大100条",
        "operationId": "list_users_api_v1_users__get",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "title": "Page"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse_UserOut_"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/topics/": {
      "post": {
        "tags": [
          "topics"
        ],
        "summary": "Create Topic",
        "description": "创建新话题端点（管理员功能）\n\n这个端点允许管理员创建新的评分话题。\n话题名称必须唯一，防止创建重复的话题。\n\n工作流程：\n1. 验证当前用户是否为管理员\n2. 检查话题名称是否已存在\n3. 创建新话题记录\n4. 返回创建的话题信息\n\nArgs:\n    topic_in: 话题创建信息，包含名称和描述\n    db: 数据库会话，用于执行数据库操作\n    admin: 通过依赖注入验证的管理员用户对象\n\nReturns:\n    TopicOut: 创建成功的话题信息\n\nRaises:\n    HTTPException:\n        - 400: 当话题名称已存在时\n        - 403: 当用户不是管理员时\n\nExample Request:\n    POST /api/v1/topics/\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n    {\n        \"name\": \"Python Programming\",\n        \"description\": \"Discussion about Python programming language\"\n    }\n\nExample Response:\n    {\n        \"topic_id\": 1,\n        \"name\": \"Python Programming\",\n        \"description\": \"Discussion about Python programming language\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }",
        "operationId": "create_topic_api_v1_topics__post",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/TopicCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TopicOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "topics"
        ],
        "summary": "List Topics",
        "description": "获取话题列表端点（支持分页）\n\n这个端点返回系统中所有可用话题的列表。\n按创建时间倒序排列，最新的话题显示在前面。\n支持分页查询，可以控制每页显示的数量和当前页码。\n\n工作流程：\n1. 计算分页偏移量\n2. 查询数据库获取话题总数\n3. 查询当前页的话题数据\n4. 计算分页元数据\n5. 返回分页响应\n\nArgs:\n    pagination: 分页参数，包含页码和每页数量\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    PaginatedResponse[TopicOut]: 包含分页元数据和话题列表的响应\n\nExample Request:\n    GET /api/v1/topics/?page=2&per_page=10\n\nExample Response:\n    {\n        \"items\": [\n            {\n                \"topic_id\": 20,\n                \"name\": \"话题名称20\",\n                \"description\": \"话题描述...\",\n                \"created_at\": \"2024-01-20T00:00:00\"\n            },\n            {\n                \"topic_id\": 19,\n                \"name\": \"话题名称19\",\n                \"description\": \"话题描述...\",\n                \"created_at\": \"2024-01-19T00:00:00\"\n            }\n        ],\n        \"total\": 50,\n        \"page\": 2,\n        \"per_page\": 10,\n        \"total_pages\": 5,\n        \"has_prev\": true,\n        \"has_next\": true\n    }\n\nNote:\n    - 这个端点是公开的，不需要认证\n    - 结果按创建时间倒序排列，最新的在前\n    - 支持分页查询，默认每页20条，最大100条",
        "operationId": "list_topics_api_v1_topics__get",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "title": "Page"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse_TopicOut_"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/topics/{topic_id}": {
      "get": {
        "tags": [
          "topics"
        ],
        "summary": "Get Topic",
        "description": "获取单个话题详情端点\n\n这个端点返回特定话题的详细信息。\n如果话题不存在，返回404错误。\n\n工作流程：\n1. 根据话题ID查询数据库\n2. 如果话题不存在，返回404错误\n3. 返回话题详细信息\n\nArgs:\n    topic_id: 话题的唯一标识符（路径参数）\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    TopicOut: 话题的详细信息\n\nRaises:\n    HTTPException: 当话题不存在时返回404错误\n\nExample Request:\n    GET /api/v1/topics/1\n\nExample Response:\n    {\n        \"topic_id\": 1,\n        \"name\": \"Python Programming\",\n        \"description\": \"Discussion about Python programming language\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }",
        "operationId": "get_topic_api_v1_topics__topic_id__get",
        "parameters": [
          {
            "name": "topic_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Topic Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TopicOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/topics/{topic_id}/stats": {
      "get": {
        "tags": [
          "topics"
        ],
        "summary": "Get Topic Stats",
        "description": "获取话题评分统计端点\n\n这个端点返回特定话题的评分统计信息，包括：\n- 平均评分\n- 评分总数\n\n工作流程：\n1. 验证话题是否存在\n2. 使用SQL聚合函数计算平均分和评分数量\n3. 返回统计信息\n\nArgs:\n    topic_id: 话题的唯一标识符（路径参数）\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    TopicStats: 包含话题统计信息的对象\n\nRaises:\n    HTTPException: 当话题不存在时返回404错误\n\nExample Request:\n    GET /api/v1/topics/1/stats\n\nExample Response:\n    {\n        \"topic_id\": 1,\n        \"avg_score\": 4.2,\n        \"rating_count\": 15\n    }\n\nNote:\n    - 如果话题还没有任何评分，avg_score会是None\n    - 这个端点是公开的，不需要认证",
        "operationId": "get_topic_stats_api_v1_topics__topic_id__stats_get",
        "parameters": [
          {
            "name": "topic_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Topic Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TopicStats"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/topics/{topic_id}/ratings": {
      "post": {
        "tags": [
          "topics"
        ],
        "summary": "Rate Topic",
        "description": "对话题进行评分端点\n\n这个端点允许认证用户对特定话题进行评分。\n每个用户对每个话题只能评分一次，如果已经评过分，则更新原有评分。\n\n工作流程：\n1. 验证话题ID的一致性（防止URL参数和请求体不一致）\n2. 验证话题是否存在\n3. 检查用户是否已经对该话题评过分\n4. 如果已评分，更新原有评分；否则创建新评分\n5. 保存到数据库并返回评分信息\n\nArgs:\n    topic_id: 话题的唯一标识符（路径参数）\n    rating_in: 评分信息，包含评分值和可选评论\n    db: 数据库会话，用于执行数据库操作\n    current_user: 当前认证用户对象\n\nReturns:\n    RatingOut: 创建或更新后的评分信息\n\nRaises:\n    HTTPException:\n        - 400: 当话题ID不匹配或话题不存在时\n        - 404: 当话题不存在时\n\nExample Request:\n    POST /api/v1/topics/1/ratings\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n    {\n        \"topic_id\": 1,\n        \"score\": 5,\n        \"comment\": \"Excellent topic for discussion!\"\n    }\n\nExample Response:\n    {\n        \"rating_id\": 1,\n        \"user_id\": 1,\n        \"topic_id\": 1,\n        \"score\": 5,\n        \"comment\": \"Excellent topic for discussion!\",\n        \"created_at\": \"2024-01-01T00:00:00\",\n        \"updated_at\": \"2024-01-01T00:00:00\"\n    }\n\nDesign Notes:\n    - 每个用户对每个话题只能有一个评分（通过数据库唯一约束保证）\n    - 支持更新评分，更新时会保留原始创建时间\n    - 评分值必须在1-5之间（通过数据库检查约束保证）",
        "operationId": "rate_topic_api_v1_topics__topic_id__ratings_post",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "parameters": [
          {
            "name": "topic_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Topic Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RatingCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RatingOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "topics"
        ],
        "summary": "List Ratings",
        "description": "获取话题评分列表端点（支持分页）\n\n这个端点返回特定话题的所有评分记录。\n按评分时间倒序排列，最新的评分显示在前面。\n支持分页查询，可以控制每页显示的数量和当前页码。\n\n工作流程：\n1. 计算分页偏移量\n2. 查询指定话题的评分总数\n3. 查询当前页的评分数据\n4. 计算分页元数据\n5. 返回分页响应\n\nArgs:\n    topic_id: 话题的唯一标识符（路径参数）\n    pagination: 分页参数，包含页码和每页数量\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    PaginatedResponse[RatingOut]: 包含分页元数据和评分列表的响应\n\nExample Request:\n    GET /api/v1/topics/1/ratings/?page=1&per_page=10\n\nExample Response:\n    {\n        \"items\": [\n            {\n                \"rating_id\": 3,\n                \"user_id\": 3,\n                \"topic_id\": 1,\n                \"score\": 4,\n                \"comment\": \"Good topic\",\n                \"created_at\": \"2024-01-03T00:00:00\",\n                \"updated_at\": \"2024-01-03T00:00:00\"\n            },\n            {\n                \"rating_id\": 2,\n                \"user_id\": 2,\n                \"topic_id\": 1,\n                \"score\": 5,\n                \"comment\": \"Excellent!\",\n                \"created_at\": \"2024-01-02T00:00:00\",\n                \"updated_at\": \"2024-01-02T00:00:00\"\n            }\n        ],\n        \"total\": 25,\n        \"page\": 1,\n        \"per_page\": 10,\n        \"total_pages\": 3,\n        \"has_prev\": false,\n        \"has_next\": true\n    }\n\nNote:\n    - 这个端点是公开的，不需要认证\n    - 结果按创建时间倒序排列，最新的在前\n    - 返回的评分信息包含用户ID，但不包含用户详细信息\n    - 支持分页查询，默认每页20条，最大100条",
        "operationId": "list_ratings_api_v1_topics__topic_id__ratings_get",
        "parameters": [
          {
            "name": "topic_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Topic Id"
            }
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "title": "Page"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse_RatingOut_"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/posts/": {
      "post": {
        "tags": [
          "posts"
        ],
        "summary": "Create Post",
        "description": "创建新帖子端点\n\n这个端点允许认证用户创建新的论坛帖子。\n帖子会自动关联到当前登录用户作为作者。\n\n工作流程：\n1. 验证用户认证状态\n2. 创建新帖子对象，关联当前用户ID\n3. 保存帖子到数据库\n4. 返回创建的帖子信息\n\nArgs:\n    post_in: 帖子创建信息，包含标题和内容\n    db: 数据库会话，用于执行数据库操作\n    current_user: 当前认证用户对象\n\nReturns:\n    PostOut: 创建成功的帖子信息\n\nExample Request:\n    POST /api/v1/posts/\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n    {\n        \"title\": \"我的第一个帖子\",\n        \"content\": \"这是帖子的正文内容...\"\n    }\n\nExample Response:\n    {\n        \"post_id\": 1,\n        \"author_id\": 1,\n        \"title\": \"我的第一个帖子\",\n        \"content\": \"这是帖子的正文内容...\",\n        \"is_deleted\": false,\n        \"created_at\": \"2024-01-01T00:00:00\",\n        \"updated_at\": \"2024-01-01T00:00:00\"\n    }\n\nSecurity Notes:\n    - 需要有效的JWT访问令牌\n    - 帖子会自动关联到当前登录用户",
        "operationId": "create_post_api_v1_posts__post",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PostCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "posts"
        ],
        "summary": "List Posts",
        "description": "获取帖子列表端点（支持分页）\n\n这个端点返回论坛中所有未被删除的帖子列表。\n按创建时间倒序排列，最新的帖子显示在前面。\n支持分页查询，可以控制每页显示的数量和当前页码。\n\n工作流程：\n1. 计算分页偏移量\n2. 查询数据库获取未被删除的帖子总数\n3. 查询当前页的帖子数据\n4. 计算分页元数据\n5. 返回分页响应\n\nArgs:\n    pagination: 分页参数，包含页码和每页数量\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    PaginatedResponse[PostOut]: 包含分页元数据和帖子列表的响应\n\nExample Request:\n    GET /api/v1/posts/?page=2&per_page=10\n\nExample Response:\n    {\n        \"items\": [\n            {\n                \"post_id\": 20,\n                \"author_id\": 5,\n                \"title\": \"帖子标题20\",\n                \"content\": \"帖子内容...\",\n                \"is_deleted\": false,\n                \"created_at\": \"2024-01-20T00:00:00\",\n                \"updated_at\": \"2024-01-20T00:00:00\"\n            },\n            {\n                \"post_id\": 19,\n                \"author_id\": 3,\n                \"title\": \"帖子标题19\",\n                \"content\": \"帖子内容...\",\n                \"is_deleted\": false,\n                \"created_at\": \"2024-01-19T00:00:00\",\n                \"updated_at\": \"2024-01-19T00:00:00\"\n            }\n        ],\n        \"total\": 50,\n        \"page\": 2,\n        \"per_page\": 10,\n        \"total_pages\": 5,\n        \"has_prev\": true,\n        \"has_next\": true\n    }\n\nNote:\n    - 这个端点是公开的，不需要认证\n    - 只返回未被删除的帖子（is_deleted = False）\n    - 结果按创建时间倒序排列，最新的在前\n    - 支持分页查询，默认每页20条，最大100条",
        "operationId": "list_posts_api_v1_posts__get",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "title": "Page"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse_PostOut_"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/posts/{post_id}": {
      "get": {
        "tags": [
          "posts"
        ],
        "summary": "Get Post",
        "description": "获取单个帖子详情端点\n\n这个端点返回特定帖子的详细信息。\n如果帖子不存在或已被删除，返回404错误。\n\n工作流程：\n1. 根据帖子ID查询数据库\n2. 验证帖子存在且未被删除\n3. 返回帖子详细信息\n\nArgs:\n    post_id: 帖子的唯一标识符（路径参数）\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    PostOut: 帖子的详细信息\n\nRaises:\n    HTTPException: 当帖子不存在或已被删除时返回404错误\n\nExample Request:\n    GET /api/v1/posts/1\n\nExample Response:\n    {\n        \"post_id\": 1,\n        \"author_id\": 1,\n        \"title\": \"我的第一个帖子\",\n        \"content\": \"这是帖子的正文内容...\",\n        \"is_deleted\": false,\n        \"created_at\": \"2024-01-01T00:00:00\",\n        \"updated_at\": \"2024-01-01T00:00:00\"\n    }",
        "operationId": "get_post_api_v1_posts__post_id__get",
        "parameters": [
          {
            "name": "post_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Post Id"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PostOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": [
          "posts"
        ],
        "summary": "Delete Post",
        "description": "删除帖子端点\n\n这个端点允许帖子作者或管理员删除帖子。\n使用软删除机制，帖子不会被物理删除，而是标记为已删除。\n\n工作流程：\n1. 根据帖子ID查询数据库\n2. 验证帖子存在\n3. 验证当前用户有删除权限（作者或管理员）\n4. 将帖子标记为已删除\n5. 保存更改到数据库\n\nArgs:\n    post_id: 帖子的唯一标识符（路径参数）\n    db: 数据库会话，用于执行数据库操作\n    current_user: 当前认证用户对象\n\nReturns:\n    204 No Content: 删除成功，无返回内容\n\nRaises:\n    HTTPException:\n        - 404: 当帖子不存在时\n        - 403: 当用户没有删除权限时\n\nExample Request:\n    DELETE /api/v1/posts/1\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n\nSecurity Notes:\n    - 只有帖子作者或管理员可以删除帖子\n    - 使用软删除，帖子数据仍然保留在数据库中",
        "operationId": "delete_post_api_v1_posts__post_id__delete",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "parameters": [
          {
            "name": "post_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Post Id"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Successful Response"
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/posts/{post_id}/comments": {
      "post": {
        "tags": [
          "posts"
        ],
        "summary": "Create Comment",
        "description": "创建评论端点\n\n这个端点允许认证用户对特定帖子发表评论。\n评论会自动关联到当前登录用户作为作者。\n\n工作流程：\n1. 验证帖子存在且未被删除\n2. 验证用户认证状态\n3. 创建新评论对象，关联当前用户和帖子\n4. 保存评论到数据库\n5. 返回创建的评论信息\n\nArgs:\n    post_id: 帖子的唯一标识符（路径参数）\n    comment_in: 评论创建信息，包含评论内容\n    db: 数据库会话，用于执行数据库操作\n    current_user: 当前认证用户对象\n\nReturns:\n    CommentOut: 创建成功的评论信息\n\nRaises:\n    HTTPException: 当帖子不存在或已被删除时返回404错误\n\nExample Request:\n    POST /api/v1/posts/1/comments\n    Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n    {\n        \"content\": \"这是一个很好的帖子！\"\n    }\n\nExample Response:\n    {\n        \"comment_id\": 1,\n        \"post_id\": 1,\n        \"author_id\": 2,\n        \"content\": \"这是一个很好的帖子！\",\n        \"is_deleted\": false,\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }\n\nSecurity Notes:\n    - 需要有效的JWT访问令牌\n    - 评论会自动关联到当前登录用户和指定帖子",
        "operationId": "create_comment_api_v1_posts__post_id__comments_post",
        "security": [
          {
            "OAuth2PasswordBearer": []
          }
        ],
        "parameters": [
          {
            "name": "post_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Post Id"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CommentCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CommentOut"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "posts"
        ],
        "summary": "List Comments",
        "description": "获取帖子评论列表端点（支持分页）\n\n这个端点返回特定帖子的所有未被删除的评论列表。\n按创建时间正序排列，最早的评论显示在前面（便于阅读对话）。\n支持分页查询，可以控制每页显示的数量和当前页码。\n\n工作流程：\n1. 计算分页偏移量\n2. 查询指定帖子的评论总数\n3. 查询当前页的评论数据\n4. 计算分页元数据\n5. 返回分页响应\n\nArgs:\n    post_id: 帖子的唯一标识符（路径参数）\n    pagination: 分页参数，包含页码和每页数量\n    db: 数据库会话，用于执行查询操作\n\nReturns:\n    PaginatedResponse[CommentOut]: 包含分页元数据和评论列表的响应\n\nExample Request:\n    GET /api/v1/posts/1/comments/?page=1&per_page=10\n\nExample Response:\n    {\n        \"items\": [\n            {\n                \"comment_id\": 1,\n                \"post_id\": 1,\n                \"author_id\": 2,\n                \"content\": \"第一个评论！\",\n                \"is_deleted\": false,\n                \"created_at\": \"2024-01-01T00:00:00\"\n            },\n            {\n                \"comment_id\": 2,\n                \"post_id\": 1,\n                \"author_id\": 3,\n                \"content\": \"我同意这个观点\",\n                \"is_deleted\": false,\n                \"created_at\": \"2024-01-01T01:00:00\"\n            }\n        ],\n        \"total\": 25,\n        \"page\": 1,\n        \"per_page\": 10,\n        \"total_pages\": 3,\n        \"has_prev\": false,\n        \"has_next\": true\n    }\n\nNote:\n    - 这个端点是公开的，不需要认证\n    - 只返回未被删除的评论（is_deleted = False）\n    - 结果按创建时间正序排列，最早的在前（便于阅读对话顺序）\n    - 支持分页查询，默认每页20条，最大100条",
        "operationId": "list_comments_api_v1_posts__post_id__comments_get",
        "parameters": [
          {
            "name": "post_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "integer",
              "title": "Post Id"
            }
          },
          {
            "name": "page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 1,
              "default": 1,
              "title": "Page"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer",
              "maximum": 100,
              "minimum": 1,
              "default": 20,
              "title": "Per Page"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PaginatedResponse_CommentOut_"
                }
              }
            }
          },
          "422": {
            "description": "Validation Error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HTTPValidationError"
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "summary": "Health Check",
        "description": "健康检查端点\n\n这个简单的端点用于：\n- 验证应用是否正常运行\n- 负载均衡器健康检查\n- 监控系统状态检测\n\n返回一个简单的JSON响应，表示应用状态正常",
        "operationId": "health_check__get",
        "responses": {
          "200": {
            "description": "Successful Response",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "Body_login_api_v1_auth_token_post": {
        "properties": {
          "grant_type": {
            "anyOf": [
              {
                "type": "string",
                "pattern": "^password$"
              },
              {
                "type": "null"
              }
            ],
            "title": "Grant Type"
          },
          "username": {
            "type": "string",
            "title": "Username"
          },
          "password": {
            "type": "string",
            "format": "password",
            "title": "Password"
          },
          "scope": {
            "type": "string",
            "title": "Scope",
            "default": ""
          },
          "client_id": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Client Id"
          },
          "client_secret": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "format": "password",
            "title": "Client Secret"
          }
        },
        "type": "object",
        "required": [
          "username",
          "password"
        ],
        "title": "Body_login_api_v1_auth_token_post"
      },
      "CommentCreate": {
        "properties": {
          "post_id": {
            "type": "integer",
            "title": "Post Id"
          },
          "content": {
            "type": "string",
            "title": "Content"
          }
        },
        "type": "object",
        "required": [
          "post_id",
          "content"
        ],
        "title": "CommentCreate",
        "description": "评论创建模式 - 创建新评论时的输入数据\n\n这个模式定义了用户对帖子发表评论时需要提供的数据格式。\n包含必要的验证规则，确保评论内容的有效性。\n\n字段说明：\n- post_id: 评论所属的帖子ID，必须与URL中的帖子ID一致\n- content: 评论正文内容，用户的回复内容\n\n验证规则：\n- 帖子ID必须与URL参数一致，防止数据不一致\n- 评论内容不能为空，支持长文本格式\n- 作者信息自动从当前登录用户获取\n\nExample Request:\n    {\n        \"post_id\": 1,\n        \"content\": \"这是一个很好的帖子，我完全同意作者的观点！\"\n    }\n\nUsage:\n    - 用于创建新评论的API端点\n    - 评论会自动关联到当前登录用户作为作者\n    - 评论会自动关联到指定的帖子\n    - 创建时间会自动设置为当前时间\n\nNote:\n    - 评论内容应该与帖子主题相关，提供有价值的讨论\n    - 评论创建后可以被其他用户查看\n    - 评论支持回复其他评论的功能（如果需要扩展）"
      },
      "CommentOut": {
        "properties": {
          "comment_id": {
            "type": "integer",
            "title": "Comment Id"
          },
          "post_id": {
            "type": "integer",
            "title": "Post Id"
          },
          "author_id": {
            "type": "integer",
            "title": "Author Id"
          },
          "content": {
            "type": "string",
            "title": "Content"
          },
          "is_deleted": {
            "type": "boolean",
            "title": "Is Deleted"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "comment_id",
          "post_id",
          "author_id",
          "content",
          "is_deleted",
          "created_at"
        ],
        "title": "CommentOut",
        "description": "评论输出模式 - 评论信息的响应格式\n\n这个模式定义了返回给客户端的评论信息格式。\n继承自ORMModel，支持从SQLAlchemy对象自动转换。\n包含评论的完整信息和相关的时间戳。\n\n字段说明：\n- comment_id: 评论的唯一标识符，由系统自动生成\n- post_id: 评论所属的帖子ID，关联到帖子表\n- author_id: 评论作者的ID，关联到用户表\n- content: 评论正文内容，用户的回复内容\n- is_deleted: 软删除标记，True表示评论已被逻辑删除\n- created_at: 评论创建时间，发表时记录\n\nExample Response:\n    {\n        \"comment_id\": 1,\n        \"post_id\": 1,\n        \"author_id\": 2,\n        \"content\": \"这是一个很好的帖子，我完全同意作者的观点！\",\n        \"is_deleted\": false,\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }\n\nUsage:\n    - 用于评论创建后的响应\n    - 用于评论列表查询\n    - 用于单个评论详情查询\n\nDesign Notes:\n    - 使用软删除机制，评论被删除时不会从数据库物理删除\n    - 软删除的评论不会在公开查询中显示\n    - 评论按创建时间正序排列，便于阅读对话顺序\n    - 评论支持嵌套回复（如果需要扩展功能）\n    - 评论可以引用其他评论（如果需要扩展功能）"
      },
      "HTTPValidationError": {
        "properties": {
          "detail": {
            "items": {
              "$ref": "#/components/schemas/ValidationError"
            },
            "type": "array",
            "title": "Detail"
          }
        },
        "type": "object",
        "title": "HTTPValidationError"
      },
      "PaginatedResponse_CommentOut_": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/CommentOut"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "per_page": {
            "type": "integer",
            "title": "Per Page"
          },
          "total_pages": {
            "type": "integer",
            "title": "Total Pages"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages",
          "has_prev",
          "has_next"
        ],
        "title": "PaginatedResponse[CommentOut]"
      },
      "PaginatedResponse_PostOut_": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/PostOut"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "per_page": {
            "type": "integer",
            "title": "Per Page"
          },
          "total_pages": {
            "type": "integer",
            "title": "Total Pages"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages",
          "has_prev",
          "has_next"
        ],
        "title": "PaginatedResponse[PostOut]"
      },
      "PaginatedResponse_RatingOut_": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/RatingOut"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "per_page": {
            "type": "integer",
            "title": "Per Page"
          },
          "total_pages": {
            "type": "integer",
            "title": "Total Pages"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages",
          "has_prev",
          "has_next"
        ],
        "title": "PaginatedResponse[RatingOut]"
      },
      "PaginatedResponse_TopicOut_": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/TopicOut"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "per_page": {
            "type": "integer",
            "title": "Per Page"
          },
          "total_pages": {
            "type": "integer",
            "title": "Total Pages"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages",
          "has_prev",
          "has_next"
        ],
        "title": "PaginatedResponse[TopicOut]"
      },
      "PaginatedResponse_UserOut_": {
        "properties": {
          "items": {
            "items": {
              "$ref": "#/components/schemas/UserOut"
            },
            "type": "array",
            "title": "Items"
          },
          "total": {
            "type": "integer",
            "title": "Total"
          },
          "page": {
            "type": "integer",
            "title": "Page"
          },
          "per_page": {
            "type": "integer",
            "title": "Per Page"
          },
          "total_pages": {
            "type": "integer",
            "title": "Total Pages"
          },
          "has_prev": {
            "type": "boolean",
            "title": "Has Prev"
          },
          "has_next": {
            "type": "boolean",
            "title": "Has Next"
          }
        },
        "type": "object",
        "required": [
          "items",
          "total",
          "page",
          "per_page",
          "total_pages",
          "has_prev",
          "has_next"
        ],
        "title": "PaginatedResponse[UserOut]"
      },
      "PostCreate": {
        "properties": {
          "title": {
            "type": "string",
            "title": "Title"
          },
          "content": {
            "type": "string",
            "title": "Content"
          }
        },
        "type": "object",
        "required": [
          "title",
          "content"
        ],
        "title": "PostCreate",
        "description": "帖子创建模式 - 创建新帖子时的输入数据\n\n这个模式定义了用户创建新帖子时需要提供的数据格式。\n包含必要的验证规则，确保帖子内容的有效性。\n\n字段说明：\n- title: 帖子标题，简要概括帖子内容\n- content: 帖子正文内容，支持长文本格式\n\n验证规则：\n- 标题不能为空，最大长度200个字符\n- 内容不能为空，支持长文本格式\n- 作者信息自动从当前登录用户获取\n\nExample Request:\n    {\n        \"title\": \"我的第一个帖子\",\n        \"content\": \"这是帖子的正文内容，可以包含详细的讨论...\"\n    }\n\nUsage:\n    - 用于创建新帖子的API端点\n    - 帖子会自动关联到当前登录用户作为作者\n    - 创建时间会自动设置为当前时间\n\nNote:\n    - 帖子标题应该简洁明了，便于其他用户快速了解内容\n    - 帖子内容支持富文本格式，可以包含详细的讨论\n    - 帖子创建后可以被其他用户查看和评论"
      },
      "PostOut": {
        "properties": {
          "post_id": {
            "type": "integer",
            "title": "Post Id"
          },
          "author_id": {
            "type": "integer",
            "title": "Author Id"
          },
          "title": {
            "type": "string",
            "title": "Title"
          },
          "content": {
            "type": "string",
            "title": "Content"
          },
          "is_deleted": {
            "type": "boolean",
            "title": "Is Deleted"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          }
        },
        "type": "object",
        "required": [
          "post_id",
          "author_id",
          "title",
          "content",
          "is_deleted",
          "created_at",
          "updated_at"
        ],
        "title": "PostOut",
        "description": "帖子输出模式 - 帖子信息的响应格式\n\n这个模式定义了返回给客户端的帖子信息格式。\n继承自ORMModel，支持从SQLAlchemy对象自动转换。\n包含帖子的完整信息和相关的时间戳。\n\n字段说明：\n- post_id: 帖子的唯一标识符，由系统自动生成\n- author_id: 帖子作者的ID，关联到用户表\n- title: 帖子标题，简要概括帖子内容\n- content: 帖子正文内容，完整的讨论内容\n- is_deleted: 软删除标记，True表示帖子已被逻辑删除\n- created_at: 帖子创建时间，首次发布时记录\n- updated_at: 帖子最后更新时间，内容被修改时更新\n\nExample Response:\n    {\n        \"post_id\": 1,\n        \"author_id\": 1,\n        \"title\": \"我的第一个帖子\",\n        \"content\": \"这是帖子的正文内容，可以包含详细的讨论...\",\n        \"is_deleted\": false,\n        \"created_at\": \"2024-01-01T00:00:00\",\n        \"updated_at\": \"2024-01-01T00:00:00\"\n    }\n\nUsage:\n    - 用于帖子创建后的响应\n    - 用于帖子列表查询\n    - 用于单个帖子详情查询\n    - 用于帖子更新后的响应\n\nDesign Notes:\n    - 使用软删除机制，帖子被删除时不会从数据库物理删除\n    - 软删除的帖子不会在公开查询中显示\n    - 创建时间和更新时间可以帮助追踪帖子的修改历史\n    - 如果帖子从未被修改过，created_at和updated_at的值相同"
      },
      "RatingCreate": {
        "properties": {
          "topic_id": {
            "type": "integer",
            "title": "Topic Id"
          },
          "score": {
            "type": "integer",
            "maximum": 5.0,
            "minimum": 1.0,
            "title": "Score"
          },
          "comment": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Comment"
          }
        },
        "type": "object",
        "required": [
          "topic_id",
          "score"
        ],
        "title": "RatingCreate",
        "description": "评分创建模式 - 创建新评分时的输入数据\n\n这个模式定义了用户对话题进行评分时需要提供的数据格式。\n包含严格的验证规则，确保评分数据的有效性。\n\n字段说明：\n- topic_id: 被评分的话题ID，必须与URL中的话题ID一致\n- score: 评分值，使用Field验证确保在1-5之间\n- comment: 评分评论，可选字段，提供评分的详细说明\n\n验证规则：\n- topic_id必须与URL参数一致，防止数据不一致\n- score必须在1-5之间（包含1和5）\n- comment可以为空，最大长度255个字符\n\nExample Request:\n    {\n        \"topic_id\": 1,\n        \"score\": 5,\n        \"comment\": \"Excellent topic for discussion!\"\n    }\n\nDesign Notes:\n    - 每个用户对每个话题只能有一个评分（通过数据库唯一约束保证）\n    - 如果用户已经对话题评过分，这个请求会更新原有评分\n    - 评分更新时会保留原始创建时间，只更新分数和评论"
      },
      "RatingOut": {
        "properties": {
          "rating_id": {
            "type": "integer",
            "title": "Rating Id"
          },
          "user_id": {
            "type": "integer",
            "title": "User Id"
          },
          "topic_id": {
            "type": "integer",
            "title": "Topic Id"
          },
          "score": {
            "type": "integer",
            "title": "Score"
          },
          "comment": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Comment"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "title": "Updated At"
          }
        },
        "type": "object",
        "required": [
          "rating_id",
          "user_id",
          "topic_id",
          "score",
          "comment",
          "created_at",
          "updated_at"
        ],
        "title": "RatingOut",
        "description": "评分输出模式 - 评分信息的响应格式\n\n这个模式定义了返回给客户端的评分信息格式。\n继承自ORMModel，支持从SQLAlchemy对象自动转换。\n包含评分的完整信息和相关的时间戳。\n\n字段说明：\n- rating_id: 评分的唯一标识符，由系统自动生成\n- user_id: 进行评分的用户ID\n- topic_id: 被评分的话题ID\n- score: 评分值，1-5分\n- comment: 评分评论，用户提供的详细说明（可选）\n- created_at: 评分创建时间，首次评分时记录\n- updated_at: 评分最后更新时间，评分被修改时更新\n\nExample Response:\n    {\n        \"rating_id\": 1,\n        \"user_id\": 1,\n        \"topic_id\": 1,\n        \"score\": 5,\n        \"comment\": \"Excellent topic for discussion!\",\n        \"created_at\": \"2024-01-01T00:00:00\",\n        \"updated_at\": \"2024-01-01T00:00:00\"\n    }\n\nUsage:\n    - 用于评分创建后的响应\n    - 用于评分列表查询\n    - 用于评分更新后的响应\n\nNote:\n    - 创建时间和更新时间可以帮助追踪评分的修改历史\n    - 如果评分从未被修改过，created_at和updated_at的值相同"
      },
      "Token": {
        "properties": {
          "access_token": {
            "type": "string",
            "title": "Access Token"
          },
          "token_type": {
            "type": "string",
            "title": "Token Type",
            "default": "bearer"
          }
        },
        "type": "object",
        "required": [
          "access_token"
        ],
        "title": "Token",
        "description": "JWT令牌响应模式\n\n这个模式定义了登录成功后返回的令牌格式。\n遵循OAuth2标准，包含访问令牌和令牌类型。\n\n字段说明：\n- access_token: JWT访问令牌字符串，用于后续API调用的认证\n- token_type: 令牌类型，固定为\"bearer\"，表示Bearer令牌\n\nBearer令牌的使用方式：\n客户端需要在Authorization头中发送：Bearer <access_token>\n\nExample:\n    {\n        \"access_token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n        \"token_type\": \"bearer\"\n    }"
      },
      "TopicCreate": {
        "properties": {
          "name": {
            "type": "string",
            "title": "Name"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          }
        },
        "type": "object",
        "required": [
          "name"
        ],
        "title": "TopicCreate",
        "description": "话题创建模式 - 创建新话题时的输入数据\n\n这个模式定义了管理员创建新话题时需要提供的数据格式。\n用于话题管理API中的创建操作。\n\n字段说明：\n- name: 话题名称，必须唯一，用于标识话题\n- description: 话题描述，可选字段，提供话题的详细说明\n\n验证规则：\n- 话题名称不能为空\n- 话题名称在系统中必须唯一\n- 描述可以为空\n\nExample Request:\n    {\n        \"name\": \"Python Programming\",\n        \"description\": \"Discussion about Python programming language\"\n    }\n\nNote:\n    - 话题名称的唯一性由数据库约束保证\n    - 创建话题需要管理员权限"
      },
      "TopicOut": {
        "properties": {
          "topic_id": {
            "type": "integer",
            "title": "Topic Id"
          },
          "name": {
            "type": "string",
            "title": "Name"
          },
          "description": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Description"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "topic_id",
          "name",
          "description",
          "created_at"
        ],
        "title": "TopicOut",
        "description": "话题输出模式 - 话题信息的响应格式\n\n这个模式定义了返回给客户端的话题信息格式。\n继承自ORMModel，支持从SQLAlchemy对象自动转换。\n包含话题的基本信息和创建时间。\n\n字段说明：\n- topic_id: 话题的唯一标识符，由系统自动生成\n- name: 话题名称，用于显示和标识\n- description: 话题描述，提供详细说明（可选）\n- created_at: 话题创建时间，自动记录\n\nExample Response:\n    {\n        \"topic_id\": 1,\n        \"name\": \"Python Programming\",\n        \"description\": \"Discussion about Python programming language\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }\n\nUsage:\n    - 用于话题列表查询\n    - 用于单个话题详情查询\n    - 用于话题创建后的响应"
      },
      "TopicStats": {
        "properties": {
          "topic_id": {
            "type": "integer",
            "title": "Topic Id"
          },
          "avg_score": {
            "anyOf": [
              {
                "type": "number"
              },
              {
                "type": "null"
              }
            ],
            "title": "Avg Score"
          },
          "rating_count": {
            "type": "integer",
            "title": "Rating Count"
          }
        },
        "type": "object",
        "required": [
          "topic_id",
          "avg_score",
          "rating_count"
        ],
        "title": "TopicStats",
        "description": "话题统计模式 - 话题评分统计信息的响应格式\n\n这个模式定义了话题评分统计信息的输出格式。\n用于显示话题的评分概况，包括平均分和评分数量。\n\n字段说明：\n- topic_id: 话题的唯一标识符\n- avg_score: 平均评分，1-5分的小数值，如果没有评分则为None\n- rating_count: 评分总数，表示有多少用户对该话题进行了评分\n\n计算方式：\n- 平均分：所有评分的总和除以评分数量\n- 评分数量：该话题的所有评分记录数\n\nExample Response:\n    {\n        \"topic_id\": 1,\n        \"avg_score\": 4.2,\n        \"rating_count\": 15\n    }\n\nNote:\n    - 如果话题还没有任何评分，avg_score字段会是None\n    - 这个模式通常用于话题详情页面的统计信息显示\n    - 统计信息是实时计算的，反映当前的数据状态"
      },
      "UserCreate": {
        "properties": {
          "username": {
            "type": "string",
            "title": "Username"
          },
          "nickname": {
            "type": "string",
            "title": "Nickname"
          },
          "password": {
            "type": "string",
            "minLength": 6,
            "title": "Password"
          },
          "role": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Role",
            "default": "user"
          }
        },
        "type": "object",
        "required": [
          "username",
          "nickname",
          "password"
        ],
        "title": "UserCreate",
        "description": "用户创建模式 - 用户注册时的输入数据\n\n这个模式定义了创建新用户时需要提供的数据格式。\n包含必要的验证规则，确保输入数据的有效性。\n\n字段说明：\n- username: 用户名，必须唯一，用于登录\n- nickname: 用户昵称，显示给其他用户的名称\n- password: 用户密码，使用constr确保最小长度为6个字符\n- role: 用户角色，可选字段，默认为\"user\"\n\n验证规则：\n- 用户名和昵称不能为空\n- 密码长度至少6个字符\n- 角色只能是预定义的值（如\"user\"、\"admin\"）\n\nExample Request:\n    {\n        \"username\": \"john_doe\",\n        \"nickname\": \"John Doe\",\n        \"password\": \"secure123\",\n        \"role\": \"user\"\n    }"
      },
      "UserOut": {
        "properties": {
          "username": {
            "type": "string",
            "title": "Username"
          },
          "nickname": {
            "type": "string",
            "title": "Nickname"
          },
          "user_id": {
            "type": "integer",
            "title": "User Id"
          },
          "role": {
            "type": "string",
            "title": "Role"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "title": "Created At"
          }
        },
        "type": "object",
        "required": [
          "username",
          "nickname",
          "user_id",
          "role",
          "created_at"
        ],
        "title": "UserOut",
        "description": "用户输出模式 - 用户信息的响应格式\n\n这个模式定义了返回给客户端的用户信息格式。\n继承自ORMModel，支持从SQLAlchemy对象自动转换。\n不包含敏感信息（如密码哈希）。\n\n字段说明：\n- user_id: 用户的唯一标识符，由系统自动生成\n- username: 用户名，用于登录的唯一标识\n- nickname: 用户昵称，显示给其他用户的友好名称\n- role: 用户角色，用于权限控制（\"user\"或\"admin\"）\n- created_at: 账户创建时间，自动记录\n\n安全考虑：\n- 不返回密码哈希等敏感信息\n- 只返回必要的用户信息\n- 支持从数据库对象自动序列化\n\nExample Response:\n    {\n        \"user_id\": 1,\n        \"username\": \"john_doe\",\n        \"nickname\": \"John Doe\",\n        \"role\": \"user\",\n        \"created_at\": \"2024-01-01T00:00:00\"\n    }"
      },
      "ValidationError": {
        "properties": {
          "loc": {
            "items": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            },
            "type": "array",
            "title": "Location"
          },
          "msg": {
            "type": "string",
            "title": "Message"
          },
          "type": {
            "type": "string",
            "title": "Error Type"
          }
        },
        "type": "object",
        "required": [
          "loc",
          "msg",
          "type"
        ],
        "title": "ValidationError"
      }
    },
    "securitySchemes": {
      "OAuth2PasswordBearer": {
        "type": "oauth2",
        "flows": {
          "password": {
            "scopes": {},
            "tokenUrl": "/api/v1/auth/token"
          }
        }
      }
    }
  }
}